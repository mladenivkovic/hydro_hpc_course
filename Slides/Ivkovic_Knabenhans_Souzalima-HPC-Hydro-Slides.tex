\documentclass[8pt]{beamer}





\usepackage{lmodern} 		% Diese beiden packages sorgen für echte 
\usepackage[T1]{fontenc}	% Umlaute.

\usepackage{amssymb, amsmath, color, graphicx, float, setspace, tipa}
\usepackage[utf8]{inputenc} 
\usepackage[english]{babel}
\usepackage[justification=centering]{caption}
\addto\captionsenglish{\renewcommand{\figurename}{}} %Abbildungen nicht bzw. anders beschriften.


%\usepackage[pdfpagelabels,pdfstartview = FitH,bookmarksopen = true,bookmarksnumbered = true,linkcolor = black,plainpages = false,hypertexnames = false,citecolor = black, breaklinks]{hyperref}
%\usepackage{url}
\usepackage{picins} 		%Gleittext um Grafik. Befehl: parpic. Vorlage siehe unten
\usepackage{longtable} 		%Seitenübergreifende Tabelle. Vorlage siehe unten
\newtheorem*{bem}{Bemerkung} % Neue Theorem-Umgebung: Bemerkung
\newcommand{\fillframe}{\vskip0pt plus 1filll} 
\newcommand{\musr}{$\mu$SR }


%-----------------
%BEAMER-SPEZIFISCH
%-----------------

\usetheme{default}
% Verschiedene Varianten von usetheme, usecolortheme und usefonttheme kann man hier ausprobieren: http://deic.uab.es/~iblanes/beamer_gallery/

% \usetheme{
% 	AnnArbor | Antibes | Bergen |
% 	Berkeley | Berlin | Boadilla |
% 	boxes | CambridgeUS | Copenhagen |
% 	Darmstadt | default | Dresden |
% 	Frankfurt | Goettingen |Hannover |
% 	Ilmenau | JuanLesPins | Luebeck |
% 	Madrid | Malmoe | Marburg |
% 	Montpellier | PaloAlto | Pittsburgh |
% 	Rochester | Singapore | Szeged |
% 	Warsaw
% }
%Interessant scheinen: Boadilla, boxes, CambridgeUS, default, (Goettingen), Hannover, Madrid, Montpellier, Pittsburgh, Rochester, Singapore, Szeged, 

\usecolortheme{dove}
% \usecolortheme{
% 	albatross | beaver | beetle |
% 	crane | default | dolphin |
% 	dove | fly | lily | orchid |
% 	rose |seagull | seahorse |
% 	sidebartab | structure |
% 	whale | wolverine
% }

\usefonttheme{structurebold}
% 	default | professionalfonts | serif |
% 	structurebold | structureitalicserif |
% 	structuresmallcapsserif
% }


%\useinnertheme{
% 	circles | default | inmargin |
% 	rectangles | rounded
% } Am besten sein lassen.


% \useoutertheme{
% 	default | infolines | miniframes |
% 	shadow | sidebar | smoothbars |
% 	smoothtree | split | tree
% } Am besten sein lassen.



\setbeamercovered{transparent} %Halbtransparente Overlays (was als nächstes Element auf der Folie gezeigt wird)
\beamertemplatenavigationsymbolsempty % Entfernt Navigationssymbole unten
%\setbeamertemplate{footline}[frame]  % Seitenzahlen
    \setbeamertemplate{footline}{%
    	\raisebox{5pt}{\makebox[\paperwidth]{\hfill\makebox[10pt]{\hyperlink{tableofcontents}{\scriptsize\insertframenumber}}}}}



%---------------------
%--Metainformationen--
%---------------------
\title{High Performance Computing 1b: Hydro Code}

\author{
	Mladen Ivkovic, Mischa Knabenhans, Rafael Souzalima
}
\date{June 2016}


% \title[Kurzform]{Vortrag zur Berechenbarkeit}
%     Titel des Vortrages
% \subtitle[Kurzform]{Untertitel}
%     Untertitel
% \author[M. Schulz]{Michael Schulz}
%     Autor festlegen
% \institute[IfI -- HU Berlin]{Institut für Informatik\\ Humboldt-Universität zu Berlin}
%     Angabe des Institutes
% \date[26.05.06]{26. Mai 2006}
%     Datum der Präsentation, alternativ kann mittels \date{\today} auch das aktuelle Datum eingetragen werden.
% \logo{\pgfimage[width=2cm,height=2cm]{hulogo}}
%     Die Datei hulogo.pdf (bzw. hulogo.png, hulogo.jpg, hulogo.mps bei Verwendung von pdftex als Backend) als Logo auf allen Folien, hier mithilfe des Paketes pgf.
% \titlegraphic{\includegraphics[width=2cm,height=2cm]{hulogo}}
%     Die Datei hulogo.pdf (bzw. analog wie bei \logo auch entsprechendes Format) als Logo nur auf der Titelseite unter Verwendung des Paketes graphicx.


%------------------------------------------------------------------
%------------------------------------------------------------------
%----------------VORLAGEN------------------------------------------
%----------------VORLAGEN------------------------------------------
%----------------VORLAGEN------------------------------------------
%------------------------------------------------------------------

%Bruch: \frac{}{}
%Kleiner Bruch: \tfrac{}{}
%Gleichungen: \begin{align}
%Delta für partielle Ableitungen: \partial
%Schönes Epsilon: \varepsilon

%Strich: in align-Umgebung, \bar{} oder \overline{}
%Seitenumbruch: \clearpage ; Besser als \newpage, da er floats zwingt, zuerst eingefügt zu werden.
%Zu grosse Zeilenabstände wegen Formelzeichen? -> \vphantom{}, \smash{}
%\newcommand{\BefehlName}[Anzahl_Parameter]{Definitiere neuen Befehl. Den ersten Parameter ruft man mit #1 ab, den zweiten mit #2 etc}

%%FIGUR
%\begin{figure}[htbp]
%\centering
%\includegraphics[width=15cm]{Bild1}%
%\caption{Experimental set-up}%
%\label{1}
%\end{figure}

%%BILD MIT PICINS NEBEN TEXT SETZEN
%\piccaption{Caption\label{label}} 
%\parpic[r]{\fbox{\includegraphics [width=5cm, keepaspectratio]{bild.png}}}
%


%% ZWEI BILDER NEBENEINANDER.
%% Schau, dass die minipages insgesamt nie mehr als 1.0\textwidth haben.
%% Um ein drittes oder viertes Bild einzufügen, ergänze einfach um weitere minipages.
% \begin{figure}[!htb]
% \centering
%   \minipage{0.3\textwidth}
%     \fbox{\includegraphics[height=2.5cm, keepaspectratio]{rsflipflop.png}}%
%     \caption{RS-Flipflop}%
%     \label{fig:rsflipflop}
%   \endminipage\hspace{1cm}   
% %
%   \minipage{0.4\textwidth}
%     \fbox{\includegraphics[height=2.5cm, keepaspectratio]{rsflipfloptakt.png}}%
%     \caption{getaktetes RS-Flipflop}%
%     \label{fig:rsflipfloptakt}
%   \endminipage
% \end{figure}



%% TABELLEN
%% 1) mit tabular
%\begin{center}
%\begin{tabular}[c]{|p{1cm}|p{3cm}|p{3cm}|p{3cm}|}
%\hline
%\multicolumn{2}{|c||}{Stromstärke 0.4A}	&	\multicolumn{2}{c|}{Stromstärke 0.6A}\\
%\hline
%$4T$ in s	&	$T'$		&	$4T$ in s	&	$T'$\\
%\hline
%7.1			&	1.775	&	7.1		& 	1.775\\
%\hline
%7.2			&	1.8		&	7.1		&	1.775\\
%\hline
%7.3			&	1.825	&	7.1		&	1.775\\
%\hline
%\end{tabular}
%\end{center}
%
%% 2) Mit longtable
%\begin{longtable}{p{3.5cm} p{11.5cm}}
%  Blabla & Blabla\\ [2mm] <= Macht 2mm Abstand zwischen Zeilen
%  %
%  Blabla & Blabla \\ [2mm]
%\end{longtable}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%






\begin{document}

% \begin{frame}[Overlay-Aktionen][Optionen]{Titel}{Untertitel}
% 
% Overlay-Aktionen
%     Overlay-Aktionen setzen die Standard-Overlay-Aktionen aller Umgebungen innerhalb des Frames, welche Aktion-Spezifikationen erlauben. Dazu gehören u.a. \item bei Listen und Block-Umgebungen.
% 
%     <+->
%         Sorgt dafür, dass die Elemente stückweise zum Vorschein kommen.
% 
% Optionen
% 
%     allowdisplaybreaks
%         Sorgt durch Aufruf von \allowdisplaybreaks aus AMS-LaTeX für einen Seitenumbruch bei mehrzeiligen Formelumgebungen. Funktioniert nur im Zusammenhang mit der Option allowframebreaks
%     allowframebreaks
%         Passt der Inhalt nicht mehr auf ein Slide, wird er automatisch auf mehrere Slides verteilt. Allerdings ist somit kein Overlay mehr möglich.
%     b,c,t
%         Sorgt dafür, dass der Frame nach unten (b), zentriert (c) oder nach oben (t) ausgerichtet wird.
%     fragile
%         Wird für Quelltextumgebungen, z.B. verbatim, benötigt.
%     label=name
%         Legt einen Namen für ein Frame fest um es später mit \againframe{name} erneut aufrufen zu können.
%     plain
%         Unterdrückt die Anzeige der Überschrift, Fußzeile und Sidebar.
%     squeeze
%         Verkleinert die vertikalen Abstände so weit wie möglich um u.U. mehr auf der Folie unterbringen zu können.
% 


\begin{frame}{}
	\titlepage
\end{frame}

\section{The Hydro Code}
\begin{frame}
	\frametitle{The Hydro Code}
	
	The hydro code solves the Euler equations $\displaystyle \frac{\partial \vec{U}}{\partial t} + \vec{\nabla} \vec{F} = 0 $ , where $\vec{U} = (...) $ is the vector containing the conserved quantities ... and $\vec{F} = (...)$  blablabla for a two dimensional hydrodynamic simulation. \\~\\
	
	The simulation domain is rectangular, divided in square cells. The boundary conditions for the outermost cells are set to simulate a wall by mirroring the last two rows of cells before the wall. \\~\\
	
	It uses a Godunov's scheme with an exact Riemann solver, which yields the following numerical equation to be solved for each cell of the domain and for both dimensions separately:
	
	\begin{align*}
		U^{n+1}_{i,j} = U^n_{i,j} + \frac{\Delta t}{\Delta x} \left( F^{n + \frac{1}{2}}_{x, i + \frac{1}{2}} -  F^{n + \frac{1}{2}}_{x, i - \frac{1}{2}}\right)
	\end{align*}
\end{frame}



\section{Parallelisation Strategy}
\begin{frame}
	\frametitle{Parallelisation Strategy}
	
	The strategy used for the parallelisation of the code was to split the simulation domain between the processors, so each processor would only work on its own part of the domain, without having knowledge of what is happening in the domains of other processors. Before each step, the borders in the direction that is being calculated are communicated to neighbouring processors, creating a connection between the split domain parts.\\~\\
	
	In the initialisation phase of the code, first the best processor distribution for a given total number of processors and simulation domain size is calculated by choosing a combination of processors in $x$ and $y$ direction which minimises the communication time, considering the lattency and the message sizes.
	
	Then, the domain is split amongst those processors as evenly as possible. If the grid size in $x$ (resp. $y$) direction is not a multiple of the number of processors assigned to the $x$ (resp. $y$) direction, the remaining amount of cells of this integer division is distributed one per processor, starting with the last in $x$ (resp. $y$) direction, so that the processor ranked $0$ would have less work, since it's the one responsible for runtime output.
	
	After this step, every processor is "taught" who its neighbours are, or whether there is a wall next to it.\\~\\
	
	The advantage of this parallelisation is that any domain size can be calculated for any numbers of processors and the most expensive part of the work is done in parallel, but the processor distribution along a direction is not freely choosable, even though it may be enforced by setting the simulation domain sizes appropriately.
\end{frame}









\section{Bottlenecks}
\begin{frame}
	\frametitle{Bottlenecks}
	We identified the bottlenecks of the code to be in the communication between the processors.\\~\\
	
	On one hand, on each calculation step, the maximal allowed time step, which ensures conservation of the conservative variables, must be recalculated by each processor. Then the minimal value of this maximal timestep must be communicated to all processors for the simulation to evolve at the same pace for each part of the domain. For this communication, we used the MPI$\_$ALLREDUCE routine. This is a blocking call and might waste processing time if processors have to wait for eachother often. To minimise waiting time, we tried to distribute the work as evenly as possible amongst the processors.
	
	On the other hand, before each calculation step, the borders of the domain have to be communicated by each processor to each of its neighbours. For this, we used a MPI$\_$SENDRECV routine, which is a blocking call as well. Since we're sending a part of an array for every communication, the MPI routine will create an array temporary for each communication. This bottleneck might be optimised by using nonblocking calls and defining a new MPI structure type, but we couldn't realise those ideas due to time limitations.
\end{frame}




\section{Performance and Scaling: Weak Scaling}

\begin{frame}
	\frametitle{Performance and Scaling: Weak Scaling} 
\end{frame}


\section{Performance and Scaling: Strong Scaling}

\begin{frame}
	\frametitle{Performance and Scaling: Strong Scaling} 
\end{frame}





\section{Zweispaltig}
\begin{frame}
	\frametitle{Zweispaltige Sachen}
    \begin{columns}
         \column{.55\textwidth}
                 \pgfimage[width=\textwidth]{Bilder/test.jpg}
         \column{.45\textwidth}
                 \begin{enumerate}
                 \item Start
                 \item Stopp
                 \end{enumerate}
    \end{columns}
\end{frame}






\section{Bilder und Quellen}
\subsection{General principle of $\mathbf{\mu}$SR}
\begin{frame}[fragile]
	\frametitle{General principle of $\mathbf{\mu}$SR}
	\begin{figure}[!htb]
		\begin{center}
			\includegraphics[height=6cm, keepaspectratio]{Bilder/musr_general_principle.png}%
			\caption*{  \setlength{\baselineskip}{6pt}
				{\tiny Dalmas de Réotier, Pierre (2010): \textit{Introduction to muon spin rotation and relaxation (\musr)} [Online]. Availible: \url{http://inac.cea.fr/Pisp/pierre.dalmas-de-				reotier/introduction_muSR.pdf}}
			}%
		\end{center}
	\end{figure}          
\end{frame}






\begin{frame}
	\frametitle{Coexistence of ferromagnetism and superconductivity in RuSr$_2$GdCu$_2$O$_8$}
	
	\begin{columns}
		\column{.55\textwidth}
		\begin{itemize}
			\item ferromagnetic phase is homogenous on a microscopic scale \vspace{10pt}
			\item it accounts for most of the sample volume\vspace{10pt}
			\item magnetic order is not significantly modified at the onset of superconductivity
		\end{itemize}
		\vspace{1cm}
		\vfill
		\setlength{\baselineskip}{6pt}      
		\begin{tiny}
			C. Bernhard, J. L. Tallon, Ch. Niedermayer, Th. Blasius, A. Golnik, E. Brücher, R. K. Kremer, D. R. Noakes, C. E. Stronach, and E. J. Ansaldo, Phys. Rev. \textbf{B} 59, 14099 (1999)
		\end{tiny}
		
		\column{.45\textwidth}
		\begin{figure}[htbp]
			\centering
			\includegraphics[width=\textwidth]{Bilder/ferromagnetism.png}%
			\caption*{\setlength{\baselineskip}{5pt}{\tiny Time-resolved normalised muon-spin polarisation $^{P(t)}/_{P(t=0)}$ at temperatures $T = 5.3K < T_{c,sc}$ and at $T_{c, sc} < T = 28K < T_{c,m}$ . The large oscillatory component gives clear evidence for the presence of a magnetically ordered state.}}%
		\end{figure}
	\end{columns}
	
	\vfill
	
	
\end{frame}





\begin{frame}
	\begin{columns}
		\column{.45\textwidth}
		\begin{block}{\textbf{5 - 6 }}
			$He$ core is homogenous (convective mixing). It will be nearly isothermal.\\~\\
			
			More and more $He$ is produced by shell burning, the core becomes more massive \\~\\			
			
			At some point, core cannot support envelope mass anymore: \\~\\
			
			
			$\Rightarrow$ core contracts, envelope expands
		\end{block}
		\column{.65\textwidth}
		\vspace{.77cm}
		\pgfimage[width=\textwidth]{Bilder/Scan_Padmanabhan_cropped.pdf}
	\end{columns}	
	\begin{center}
		\fillframe
		\setlength{\baselineskip}{0pt}
		{\tiny
			T. Padmanabhan, "Theoretical Astrophysics Volume II: Stars and Stellar Systems". New York: Cambridge University Press, 2001.
		}
	\end{center}
\end{frame}




\end{document}
