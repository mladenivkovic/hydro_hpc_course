#!/bin/bash

# creates a movie of HYDRO output files named movie.mp4
# execute in the directory where the outputs are
# It puts the .png output in subdirectory picoutput_parallel.
# The script requires to be run in the same directory as the
# hydro output is and needs a hydro_runinfo.txt file, which
# is generated by the hydro script.
# NEW: DOESN'T REQUIRE NR OF PROCS AS CMD LINE ARG



#check if subdir "picoutput" exists. if not, create it.
if [ -d "picoutput_parallel" ]; then
    echo "Directory picoutput_parallel already exists."
else
    mkdir -p picoutput_parallel
    echo "made new dir picoutput_parallel"
fi


echo "creating png files"
for i in output_*.00001; do
    name=${i:0:12}
    hydropic_movie_parallel_dry ./"$name"*
    #echo ./"$name"*
done
echo "png files created"


#create movie out of png
echo "creating movie"
cd picoutput_parallel
hydro-ffmpeg_makemovie
cd ..

echo "done"

